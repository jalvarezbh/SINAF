/*
Deployment script for db_interf_cabtec

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "db_interf_cabtec"
:setvar DefaultFilePrefix "db_interf_cabtec"
:setvar DefaultDataPath "C:\Arquivos de programas\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Arquivos de programas\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Starting rebuilding table [dbo].[MobileTSimuladorSubAgregado]...';


GO
BEGIN TRANSACTION;

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

SET XACT_ABORT ON;

CREATE TABLE [dbo].[tmp_ms_xx_MobileTSimuladorSubAgregado] (
    [IDSimuladorSubAgregado] BIGINT         IDENTITY (1, 1) NOT NULL,
    [CodigoEntrevista]       BIGINT         NOT NULL,
    [GrauParentesco]         NVARCHAR (50)  NOT NULL,
    [Idade]                  INT            NOT NULL,
    [PremioAgregado]         NUMERIC (8, 2) NOT NULL,
    [Funeral]                NVARCHAR (50)  NOT NULL,
    [IDSimuladorProduto]     BIGINT         NOT NULL,
    CONSTRAINT [tmp_ms_xx_constraint_MobileTSimuladorSubAgregado_PK] PRIMARY KEY CLUSTERED ([IDSimuladorSubAgregado] ASC, [CodigoEntrevista] ASC, [IDSimuladorProduto] ASC) WITH (STATISTICS_NORECOMPUTE = ON)
);

IF EXISTS (SELECT TOP 1 1 
           FROM   [dbo].[MobileTSimuladorSubAgregado])
    BEGIN
        SET IDENTITY_INSERT [dbo].[tmp_ms_xx_MobileTSimuladorSubAgregado] ON;
        INSERT INTO [dbo].[tmp_ms_xx_MobileTSimuladorSubAgregado] ([IDSimuladorSubAgregado], [CodigoEntrevista], [IDSimuladorProduto], [GrauParentesco], [Idade], [PremioAgregado], [Funeral])
        SELECT   [IDSimuladorSubAgregado],
                 [CodigoEntrevista],
                 [IDSimuladorProduto],
                 [GrauParentesco],
                 [Idade],
                 [PremioAgregado],
                 [Funeral]
        FROM     [dbo].[MobileTSimuladorSubAgregado]
        ORDER BY [IDSimuladorSubAgregado] ASC, [CodigoEntrevista] ASC, [IDSimuladorProduto] ASC;
        SET IDENTITY_INSERT [dbo].[tmp_ms_xx_MobileTSimuladorSubAgregado] OFF;
    END

DROP TABLE [dbo].[MobileTSimuladorSubAgregado];

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_MobileTSimuladorSubAgregado]', N'MobileTSimuladorSubAgregado';

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_constraint_MobileTSimuladorSubAgregado_PK]', N'MobileTSimuladorSubAgregado_PK', N'OBJECT';

COMMIT TRANSACTION;

SET TRANSACTION ISOLATION LEVEL READ COMMITTED;


GO
PRINT N'Starting rebuilding table [dbo].[MobileTSimuladorSubFuneral]...';


GO
BEGIN TRANSACTION;

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

SET XACT_ABORT ON;

CREATE TABLE [dbo].[tmp_ms_xx_MobileTSimuladorSubFuneral] (
    [CodigoEntrevista]            BIGINT         NOT NULL,
    [ProtecaoCoberturaMorte]      NUMERIC (8, 2) NULL,
    [ProtecaoCoberturaAcidente]   NUMERIC (8, 2) NULL,
    [ProtecaoCoberturaEmergencia] NUMERIC (8, 2) NULL,
    [ProtecaoCategoria]           NVARCHAR (50)  NULL,
    [ProtecaoPremio]              NUMERIC (8, 2) NULL,
    [SeniorCoberturaMorte]        NUMERIC (8, 2) NULL,
    [SeniorCategoria]             NVARCHAR (50)  NULL,
    [SeniorPremio]                NUMERIC (8, 2) NULL,
    [CasalCoberturaMorte]         NUMERIC (8, 2) NULL,
    [CasalCoberturaConjuge]       NUMERIC (8, 2) NULL,
    [CasalCategoria]              NVARCHAR (50)  NULL,
    [CasalPremio]                 NUMERIC (8, 2) NULL,
    [IDSimuladorProduto]          BIGINT         NOT NULL,
    CONSTRAINT [tmp_ms_xx_constraint_MobileTSimuladorSubFuneral_PK] PRIMARY KEY CLUSTERED ([CodigoEntrevista] ASC, [IDSimuladorProduto] ASC) WITH (STATISTICS_NORECOMPUTE = ON)
);

IF EXISTS (SELECT TOP 1 1 
           FROM   [dbo].[MobileTSimuladorSubFuneral])
    BEGIN
        INSERT INTO [dbo].[tmp_ms_xx_MobileTSimuladorSubFuneral] ([CodigoEntrevista], [IDSimuladorProduto], [ProtecaoCoberturaMorte], [ProtecaoCoberturaAcidente], [ProtecaoCoberturaEmergencia], [ProtecaoCategoria], [ProtecaoPremio], [SeniorCoberturaMorte], [SeniorCategoria], [SeniorPremio], [CasalCoberturaMorte], [CasalCoberturaConjuge], [CasalCategoria], [CasalPremio])
        SELECT   [CodigoEntrevista],
                 [IDSimuladorProduto],
                 [ProtecaoCoberturaMorte],
                 [ProtecaoCoberturaAcidente],
                 [ProtecaoCoberturaEmergencia],
                 [ProtecaoCategoria],
                 [ProtecaoPremio],
                 [SeniorCoberturaMorte],
                 [SeniorCategoria],
                 [SeniorPremio],
                 [CasalCoberturaMorte],
                 [CasalCoberturaConjuge],
                 [CasalCategoria],
                 [CasalPremio]
        FROM     [dbo].[MobileTSimuladorSubFuneral]
        ORDER BY [CodigoEntrevista] ASC, [IDSimuladorProduto] ASC;
    END

DROP TABLE [dbo].[MobileTSimuladorSubFuneral];

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_MobileTSimuladorSubFuneral]', N'MobileTSimuladorSubFuneral';

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_constraint_MobileTSimuladorSubFuneral_PK]', N'MobileTSimuladorSubFuneral_PK', N'OBJECT';

COMMIT TRANSACTION;

SET TRANSACTION ISOLATION LEVEL READ COMMITTED;


GO
PRINT N'Starting rebuilding table [dbo].[MobileTSimuladorSubRenda]...';


GO
BEGIN TRANSACTION;

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

SET XACT_ABORT ON;

CREATE TABLE [dbo].[tmp_ms_xx_MobileTSimuladorSubRenda] (
    [CodigoEntrevista]   BIGINT         NOT NULL,
    [Periodo]            NVARCHAR (50)  NOT NULL,
    [ValorRenda]         NUMERIC (8, 2) NOT NULL,
    [Capital]            NUMERIC (8, 2) NOT NULL,
    [PremioRenda]        NUMERIC (8, 2) NOT NULL,
    [IDSimuladorProduto] BIGINT         NOT NULL,
    CONSTRAINT [tmp_ms_xx_constraint_MobileTSimuladorSubRenda_PK] PRIMARY KEY CLUSTERED ([CodigoEntrevista] ASC, [IDSimuladorProduto] ASC) WITH (STATISTICS_NORECOMPUTE = ON)
);

IF EXISTS (SELECT TOP 1 1 
           FROM   [dbo].[MobileTSimuladorSubRenda])
    BEGIN
        INSERT INTO [dbo].[tmp_ms_xx_MobileTSimuladorSubRenda] ([CodigoEntrevista], [IDSimuladorProduto], [Periodo], [ValorRenda], [Capital], [PremioRenda])
        SELECT   [CodigoEntrevista],
                 [IDSimuladorProduto],
                 [Periodo],
                 [ValorRenda],
                 [Capital],
                 [PremioRenda]
        FROM     [dbo].[MobileTSimuladorSubRenda]
        ORDER BY [CodigoEntrevista] ASC, [IDSimuladorProduto] ASC;
    END

DROP TABLE [dbo].[MobileTSimuladorSubRenda];

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_MobileTSimuladorSubRenda]', N'MobileTSimuladorSubRenda';

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_constraint_MobileTSimuladorSubRenda_PK]', N'MobileTSimuladorSubRenda_PK', N'OBJECT';

COMMIT TRANSACTION;

SET TRANSACTION ISOLATION LEVEL READ COMMITTED;


GO
PRINT N'Update complete.';


GO
